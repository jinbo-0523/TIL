まずなになにを守りたいのか明確に
三要素としてのCIA（機密性・完全性・可用性）
セキュリティを考える時の観点【機密性・完全性・可用性】
・機密性：外に漏れない
・完全性：勝手に書き換えられない
・可用性：常に使える


追加された真正性・責任追及性・否認防止性・信頼性


三要素が侵害されると異常が足りなかった場合起こる
問題
・情報漏洩→機密が外部に漏れる
・改竄→情報を書き換えされる
・サービス妨害→サービス提供が邪魔されること➡️つまりサービスの設計の時点で『アクセス数の予測』はセキュリテイの観点からも重要ってこと　　　


何を守るかをしっかり考える
これがはっきりしないと、具体的な対策も立てられない
守るべきものとそのリスク（敵）


守るべきもの
・個人情報
・マイナンバー
・会社などの機密情報（営業秘密、機密情報）
・会社が運営しているシステム（Webコンテンツ）
・自身が使っている決済情報や認証システム（IDやパスワード）


守るべき理由
・法律で定められている
・契約に盛り込まれている
・経済的損害やブランド毀損を発生させない
・自信を守るため


個人情報の中でも、さらに...
・要配慮個人情報（第三者提供：可）
　→人種、信条、社会的身分、病歴、犯罪歴➡️知られると本人に不利益が生じるもの
・特定個人情報（第三者提供：不可）
　→個人情報＋マイナンバー➡️使用に厳格な規則がある（使用者・用途が限定的かつ刑事罰対象）


２、基礎知識

よく見る『セキュリティポリシー』
何かを決めるには手順を決めるには「基準」がいる→基準を決めるには「方針」がいる
この方針がポリシーに当たる。『セキュリティポリシー』はセキュリティに関する方針を組織で決めた内容

セキュリティポリシーを決めるのに必要なこと
①組織の目的や目標を明確にする
②経営層の関与・関心

セキュリティポリシーが決まったら、基準（スタンダード）、手順（プロシージャ）の順で制定


事故対応（インシデント）のフェーズ
①検知・・・攻撃や被害を検出・知る
②初動対応・・・原因の特定と対処
③復旧・・・被害を受けた機器の再構築/修復
④事後対応・・・最終報告書の作成、再発防止の対処

認証と認可
同じような意味だと思われやすい内容だけど違う
認証
認証・・・利用者の特定・識別する事。パスワードの使用など
認可・・・利用者が処理やサービスを許可する事


暗号
暗号化するには
　暗号アルゴリズムと鍵
複合するには
　複合アルゴリズムと鍵

共通鍵暗号
　暗号化と復号に同じ鍵を使用
公開鍵暗号
　暗号化と復号で別の鍵を使用

『鍵配送問題』・・・★★あとで調べる★★

ハッシュ
・あるデータに対応する値を求めるための手法

ハッシュアルゴリズム
・ハッシュ値を計算するための手順。安全性は「衝突」に対しての耐性があるか
・衝突・・・ファイルAに対してハッシュ値aの組み合わせがあったとして、ハッシュ値aを持つ別のファイルが作り出せるかどうか


ハードニング
・セキュリティの文脈では『固くする』という。もしくは『要塞化』。
・以下のことを継続・確認すること
・外部に公開するサービスの局所化
・動作しているのもも把握
・不必要なプログラムの停止
・脆弱性の修正するパッチの迅速な適用
・セキュリティソフトウェアや機器の導入
・複数の箇所で多層防御

例として
・ファイアウォールの導入
・通信先を絞る
・動作プログラムを限定し、最小限のものにする
・プログラム、OSを随時最新化
・IDSやIPSの導入
がある





パスワード
・システムに登録されているユーザーを認証するための情報。
自分で決められる反面、容易なパスワードにすると悪用の危険が高まる。
利用しているサービスのセキュリティレベルがわかる方法としてパスワードを忘れた際、リセットの方法が、パスワードを平文でメールに記載するような方法だとセキュリティの観点ではあまり良くないサービスと言える


バイオメトリック認証
・生体が持つ各種特徴を認証に用いる認証方式
・現在は顔、指紋、、静脈、虹彩・網膜認証がある
なりすましの著しく困難で利用側も負担が少ないが、認証のシステムや装置が高価。本人であったとしても失敗や本人以外が成功したりといった認証誤りが起こることがある。
本人拒否率（FRR）と他人受入率（FAR）のバランス
・FRR・・・本人拒否率を下げると他人に認証が突破され易くなる
・FAR・・・他人に対して強固にすると本人も認証されなくなる率も上がる
認証をかけたい内容によってFRRとFARの数値を調整しなければならない


ワンタイムパスワード
・専用の機器やソフトウェアを使って生成されるパス使用すると二度度使うことができない。
・長所と短所
長所・・・例えパスが漏れたとしても二度目は使えないので安全性が高い
短所・・・専用の機器・ソフトを使うため維持コストがかかる。ユーザー側にも準備やソフトが必要になる。
高い安全性が求められるサービスやオンラインバンキングなどに使われる認証方法


二要素認証
素性の異なる2種類の情報を組み合わせてにんしょうを行う方式
例：⭕️パスと認証コード
　　❌ID(メアド)と認証コード→メアドが漏れると認証コードもわかってしまう
長所と短所
長所・・・どちらか一方が漏れてもセキュリティが確保される事
短所・・・維持コストとユーザー負担


シングルサインイオン
一度の認証で複数システムが使用できる
仕様上、通常よりもセキュリティを確保しなければならない→認証が通れば複数システムを悪用されてしまう。
SAML・・・企業の利用想定の認可・認証
OpenID・・・認証
OAuth・・・認可v


認証　認可　　　標準団体
SAML　⭕️　　⭕️　　　　　OASIS
OpenID ⭕️　　　　　　　　IETF
OAuth　　　　⭕️


電子署名とその応用例
元のデータに『電子データの作成者』も付与し、元データが改竄されていない事を保証する技術。書類のサイン・押印を電子的に実現したもの
電子署名に必要な３つのアルゴリズム
①鍵生成アルゴリズム・・・秘密鍵と公開鍵を生成する
②署名アルゴリズム
③検証アルゴリズム
よく使われる電子署名の方式
RSA、Elgamal、DSA


証明局と認証局
証明書・・・自身が正しい存在であることを示すために用いる仕組み。発行者、発行を受けた者、有効期限が含まれる
発行の仕組み・・・認証局が発行、認証局を維持する仕組みをPKIという
検証方法・・・通常はOSやブラウザに配布されているもの(ルート証明書)と、「サーバーを運用する側」がサーバー証明書とともにサーバーに格納する(中間証明書)

暗号化ファイルシステム
鍵をもっている人のみがデータが見れるのが暗号化。ファイル自体に暗号化機能を追加してファイルを暗号化する技術
アクセス権が付与されていれば読み書きができて付与されたいなければできないというシンプルなものなのなのでユーザーが暗号化を意識する必要がない。
紛失しても情報漏洩する危険は低いが、短所としてディスク破損などのトラブル時データの救出がしたくてもできない点


ウィルススキャン
①ウィルス辞典から探して◯す②変な動きしたら◯す③情報提供で◯す
悪意のあるソフト(マルウェア)を検知するための手段。
①パターンで検知・・・特徴をまとめたDB(パターンファイル)があり、スキャンしてDBと結果が同じパターンだった場合、退避・削除する
②振る舞いを検知・・・最近はマルウェアが巧妙化しスキャンでは検知が難しくなっているので動作し始めた時(攻撃指示待ちや不自然なファイルの作成)にウィルスと判断している
③レピュテーション(英語で評判の意)による検知・・・セキュリティ事業者が保有しているマルウェアや攻撃者が使う悪性URLなどの最新情報と比較してユーザーの保護をする。アクセスや実行をブロックする。

パッチ
バグ修正のためのファイルの総称。
方法
①ファイルの差し替え
②ファイルの追加
③既存ファイルの中身修正
④ファイルを差し替えてコンパイル
⑤一部修正して再コンパイル
⑥動作中のプログラムのメモリ内のデータを直接修正

長所と短所
一部を変更するだけなので迅速に行える
ただし、ソフトウェアが不安定になるためテスト環境で適用テストが必要になる。
かと言ってテストに時間をかけると脆弱性は変わらないので、危険な状態にあることは変わらないことに注意


パケットフィルタリングとアプリケーションゲートウェイ
ますはパケットについて
ネットワーク上の単位。①ヘッダーと②ペイロードというものに分けられる。ヘッダーが『荷札』でペイロードが『荷物そのもの』。
①・・・『送信元IPアドレス』『送信先IPアドレス』『送信元ポート番号』『送信先ポート番号』
②・・・データの部分
通信規約であるIPに従って分割されたデータのことをIPパケットという


パケットフィルタリング
パケットごとに①の条件を設定して通信の可否を制御できる。
→荷札を確認して家に荷物をお届け
ざっくり判断、けど高速
アプリケーションゲートウェイ
アプリケーションで扱うデータを通信路上で確認し条件に合致するかを判断する
処理に時間がかかるが、細かい設定ができる
→荷物の中身を確認して家にお届け


SOC（セキュリティオペレーションセンター）
監視対象に起きたイベントを検知し取捨選択して、通知先に知らせる一連の流れ
『監視と通知』

CSIRT
SOCが監視と通知なら、CSIRTはその通知を受けてセキュリティの事故の対応する

対応の流れ
攻撃を受ける→セキュリティイベント通知→SOCで検知→SIEMでログの収集・解析→CSIRTへ通知→CSIRTが対応を判断

SDL（セキュリティ  ディベロップメント ライフサイクル）
ソフトウェアの不具合修正には特有の法則があり、初期であるほどコストが低く、工程の後になればなるほどコストが増大するというもの。
セキュリティも例外なくその法則に当たるがセキュリティの場合、テストをする際にサービスやシステムに影響が出るレベルの脅威のテストデータとして作り出さないといけない。
運用前にセキュリティテストをしないと膨大なコストがかかるが、運用前にそのテストデータを作るのは非常に困難。
『SDL』は2004年にマイクロソフト社が提唱した、安全なソフトウェア製品開発のための開発プロセスのこと。
正式には「信頼できるコンピューティングのセキュリティ開発ライフサイクル(Trustworthy Computing Security Development Lifecycle: SDL)」

各種ログ
ネットワーク機器のログ
通信面での記録。指定外の通信を止めた記録が残っていれば通信自体は止めずに不審な通信を確認できる。


サーバのログ
プログラムの記録。不審なプログラム起動を確認するのに役に立つ。性能ログを取れるようにしておけば負荷推移を残せるので、ふしんなプログラムの起動がわかる。


CSIRT
セキュリティの事故対応を行うチーム
情報共有→社内外の★Poc・・・法務、渉外、IT部門、後方各事業部との連携
情報収集・分析→リサーチャー(収集)、キュレーター(分析担当)・・・定例業務、インシデント対応情報収集、各種情報に対する分析、国際情勢の把握
インシデント対応→★コマンダー、インシデントマネージャー、インシデントハンドラー・・・CSIRTの全体統括、意思決定、社内Poc・役員・CSIRT・CSOまたは経営者層との情報連携
インシデントの対応状況の把握、コマンダーへの報告、対応履歴把握
発生したインシデントの処理、インシデントマネージャへの報告

事故対応が仕事だが主な業務は事故が起こらないように準備すること
対応したセキュリティ事故から『具体的な予防策・改善策の検討』

重要な役割は★のポジションで必ずどのようなCSIRTにも設置する必要がある。


３、攻撃を検知・解析するための仕組み

サンドボックス
不審なソフトを自身の環境で試すための仕組み。外部に影響が及ばない範囲で使用できる。
仮想マシン環境もその一つ。
外部に影響を及ぼさないような技術や機能を用いて、処理内容を確認できるように作られた実行環境の事の総称
仮想マシン環境をサンドボックスに見立てるか、サンドボックス製品を使ってボックス内で実行するかして、マルウェアの検知や実行をする。


表層解析
ファイルの名前・種類・ハッシュ値などの外形的な情報を元に解析情報をネットか探してくる解析方法。表層解析で情報が足りない場合には動的解析・静的解析を行う。


動的解析（準備は必要だが解析に比較的早くできる。ただし不発に終わることある）
動的解析はマルウェアを実際に動作させてどのような挙動をするか確認して解析する方法
メリット・デメリット
解析結果を得るのが早く、実際の動きが分かる点はメリットではあるが、実際にマルウェアを入手してなければならない事に加え動作の条件や環境もあらかじめ解析していなければならない。また、仮想マシンのようなサンドボックスの環境を使うが攻撃者も簡単に解析されたくないので最近では仮想環境では動作しないようなマルウェアも存在する。


静的解析（準備は少なくて良いが解析に時間がかかる）
実際に被害にあったPC残されたファイルやメモリに残存するマルウェアの情報を見て解析する方法
メリット・デメリット
マルウェアがなくても解析できる事が長所だがデメリットが３てある。
①時間がかかる（プログラムを動かさずに読むため）
②膨大な知識が必要（動作環境・ホストの通信・動作環境など）
③解析対象のプログラムに書かれている以上のことは分からない

解析には動的・静的解析両方を組み合わせるのがベスト
短所を補い合う感じ
静的解析で動作環境などの条件を確認、動的解析でマルウェアを解析を実施

フォレンジック
コンピューターに残っている情報を収集、行われていたことを特定、その内容の調査の総称。

フォレンジックを行う際に考えることは・・・
被害にあったコンピューターの保全。電源を切って不必要に記憶装置が改変されないようにする。それから別のコンピューターに書き出し(メモリダンプ)を行う事で、削除されたファイル・ログ・各種設定の調査を行う事で被害状況が分かるようになる。

また、調査自体はHDDを複製するところから始まるが、現在のHDD容量が多い物（TB(テラバイト)）もあり複製にそもそも時間がかかる。さらに記憶装置を細かく調査するので時間がかかる。


パケットキャプチャ
パケット（データを送信するときに入れる箱）をキャプチャ（取得）する事。データの調査のために取得する事
・パケットキャプチャ用のツール
Linuxではtcpdump、WindowsではMicrosoftからネットワークモニターが提供されている。
・それ以外
Wireshark
Winpcap
Win10pcap
つまり何するもの？
パケットキャプチャツールはネットワーク上に流れる「生のパケット」をすくい取り、表示してくれるツール。これを使う事で障害・問題が起きたときの対処を早めることができる。
・DNSサーバー
Domain Name Systemサーバー・・・IPアドレスなどといった必要な情報を得る（名前を解決する）ために、ネットワーク上で情報を提供する仕組み

・必要なもの
このツールが動作しているコンピューターが受信できるパケットのみ取得できる。なのでネットワークに流れるデータを取得しようと思ったら通信データを複製できるミラーポートという機能を持ったネットワークスイッチが必要になる。ただし、何でもかんでも複製して中身（データ）を見れるわけではなく、VPN通信や暗号化によって復号する鍵がなければ中身を確認することはできない。

　VPN・・・VPN(Virtual Private Network)とは、インターネットなどに接続している利用者の間に仮想的なトンネルを構築し、プライベートなネットワークを拡張する技術です


SIEM
SIMとSEMを合わせた言葉
セキュリティのSIM（Security Information Management）とスマホのSIM（Subscriber Identity Module）とはもちろん違う。
さまざまな機器からログの収集・蓄積とリアルタイム分析による脅威の検知支援が目的。SIEMをしっかり設置することにより脅威の早期発見ができるようになる。ただしどんなに良い物も使わなければ意味がないのと一緒で、日常運用にしっかり組み込むことが重要。

ハニーポットとハニーネット
ハニーポット
囮りのコンピューター。攻撃者に魅力的に見える（脆弱な本番環境）ように作られている偽物の環境で、攻撃者がどのように偽物の環境を攻撃するか監視している。

ハニーネット
ハニーポットとは違い、ネットワーク全体を囮りにし攻撃者を監視する。

メリットデメリット
釣れれば攻撃者の手口を全て把握することができるが、ウラを返せば自分の環境を攻撃者に好きなように触らせることになる。乗っ取りや踏み台にされる危険性があるため高度な技術やノウハウが必要になる。


４、セキュリティを脅かす存在と攻撃の手口
NICT(国立研究開発法人 情報通信研究機構)が運営する大規模なサイバー攻撃観測・分析システムnicterWebによれば、2015年における日本へのサイバー攻撃に関連する通信が約545億1,000万件に達したことが明らかになっている。

攻撃者
目的や意図を持ってシステムやソフトウェアを攻撃する者を攻撃者という。
理由の多数を占めるのは①『カネ』と②『機密情報』になる。
①カネを目的とする攻撃者の方法は『バラマキ型攻撃』が多い。不特定多数の人がアクセスするWebサイトに悪意のあるコンテンツを書き込むなどして攻撃する。
フィッシングサイトを使えば個人のクレジット情報や決済情報が知られてしまう。
②機密情報を目的とする攻撃方法は『標的型攻撃』が多く、悪意のあるメールを送りつけることで攻撃、送られてきたメールを開いてしまったり、ファイルをダウンロードしてしまうとマルウェアに感染し機密情報を盗まれてしまう。機密情報とは企業の業務内容顧客情報、給与情報および住所録、昇格に関する情報、仕入先リストなどがあたる。


脆弱性
脆弱性とは、システムやソフトウェアのセキュリティ上の弱点のこと
バグ(システムやソフトウェアの欠陥)とは違い『特敵の攻撃に対してのみ、意図していない挙動をする事』を脆弱性ということが多い。
事前に脆弱性をなくすためにペネトレーションテストや脆弱性検査テストなどを行うが実運用前に完全になくすことは困難となっている。
日本では一般人が脆弱性を見つけた場合『情報処理推進機構(IPA)』に届出をすることになっている。


